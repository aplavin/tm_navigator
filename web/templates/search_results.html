{% extends "search_results_base.html" %}
{% import "macros.html" as macros %}

{% set groups_max = 100 %}

{% block body %}
<div class="row">
    {% if present_as.startswith('groupby:') %}
        <div id="sidebar" class="col-sm-3">
            <h3>Groups</h3>
            <ul class="nav nav-pills nav-stacked">
                {% for term, cnt in results[:groups_max] %}
                    <li class="{{ 'active' if loop.first else '' }}">
                        <a href="#{{ term.text | slug }}" class="dynamic" data-url="{{ url_for('documents:search_results_group', query=query, modality_id=term.modality_id, term_id=term.id) }}" data-target="#group-content" data-toggle="pill">
                            <span class="badge pull-right">{{ cnt }}</span>
                            {{ term.text }}
                        </a>
                    </li>
                {% endfor %}

                <script>
                    $(document).ready(function() {$('a.dynamic').first().click();});
                </script>

                {% if results|length > groups_max %}
                    <li class="bg-info">... {{ results|length - groups_max }} groups more ...</li>
                {% endif %}
            </ul>
        </div>
    {% endif %}

    <div id="main" class="col-sm-{{ '9' if present_as.startswith('groupby:') else '12' }} tab-content">
        <h2>{{ 'Topics' if as_topics else ('Matched documents' if query else 'Documents') }}</h2>
        <div id='group-content'>
            {% if not present_as.startswith('groupby:') %}
                {% include 'search_results_group.html' %}
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}